let j=[],u={latitude:33,longitude:-70};async function g(){let h=await fetch(jsonURl,{headers:new Headers({"Content-Type":"application/json"})});return j=await h.json(),j}async function l(){return new Promise((h,e)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{let n=t.coords.latitude,o=t.coords.longitude;u={latitude:n,longitude:o},h({latitude:n,longitude:o})},t=>{e(t)}):e(new Error("Geolocation is not supported"))})}function c(h,e=u){function t(n,o,r,s){let a=(r-n)*Math.PI/180,i=(s-o)*Math.PI/180,d=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}let n=function(o,r,s){let a=null,i=1/0;for(let d of s){let m=t(o,r,d.lat,d.lon);m<i&&(i=m,a=d)}return a}(e.latitude,e.longitude,h),o=document.getElementById("canvas"),r=document.getElementById("clickTag");r.style.zIndex="2";let s=document.createElement("div");s.style.cssText="width:83px;height:21px;position:absolute;font-family:Arial,sans-serif;font-size:12px;font-weight:bold;top:65px;left:159.33331298828px;background-color:rgb(246 247 245);display:flex;justify-content:center;align-items:center;z-index:1;color:#000",s.innerHTML=`<span>${n.comuna}</span>`,o.appendChild(s);let a=document.createElement("div");a.style.cssText="width:120px;height:45px;position:absolute;font-family:Arial,sans-serif;font-size:55px;font-weight:bold;top:22px;left:145px;background-color:rgb(246 247 245);display:flex;justify-content:center;align-items:center;z-index:1;color:#ff0080",a.innerHTML=`<span>${Math.round(n.clima.temperatura)}Â°</span>`,o.appendChild(a);let i=document.createElement("div");i.style.cssText="display:block;position:absolute;width:70px;height:70px;visibility:visible;left:66px;opacity:1;top:25px;background-color:rgb(246 247 245);z-index:1",i.innerHTML=`<img src="icons/${n.clima.icono}_t.png" alt="icon" style="width:100%;height:100%;">`,o.appendChild(i);let d=document.createElement("div"),m=new Date,p=m.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"});d.style.cssText="width:130px;height:11px;position:absolute;font-family:Arial,sans-serif;font-size:10px;font-weight:bold;top:84px;left:135px;background-color:rgb(246 247 245);display:flex;justify-content:center;align-items:center;z-index:1;color:#000",d.innerHTML=`<span>${p}</span>`,o.appendChild(d)}async function f(){try{let h=await l(),e=await g();c(e,h)}catch(h){console.error("Error:",h.message)}}f();